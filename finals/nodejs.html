<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Web Notes</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <!--<link rel="stylesheet" href="css/bootstrap-theme.min.css.map">-->
    <link rel="stylesheet" href="../css/general.css">
    <link rel="stylesheet" href="../css/github.css">

</head>
<body>
<header>
    <nav class="container navbar navbar-default">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Web Technologies Notes</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li><a href="../index.html">PRELIMS <span class="sr-only">(current)</span></a></li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="midterms/midterms.html">MIDTERMS
                            <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="../midterms/midterms.html">Front End Development</a></li>
                            <li><a href="../midterms/html.html">HTML</a></li>
                            <li><a href="../midterms/css.html">CSS</a></li>
                            <li><a href="../midterms/javascript.html">JavaScript</a></li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="midterms/midterms.html">
                            FINALS
                            <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="../finals/java.html">Java</a></li>
                            <li><a href="../finals/php.html">Php</a></li>
                            <li><a href="../finals/nodejs.html">Node JS</a></li>
                            <li><a href="../finals/security.html">Security</a></li>
                        </ul>
                    </li>
                    <li><a href="../about.html">ABOUT</a></li>
                </ul>

            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>
</header>
<!-- div For styling -->
<div class="container">
    <h1 class="page-header">Node.js</h1>
    <nav class="well well-sm">
        <h2 class="page-header" class="page-header" style="border-bottom: 1px solid lightgrey; padding-bottom: 2%; ">
            Contents</h2>
        <ul>
            <li><a href="#intro">Introduction</a>
                <ul>
                    <li><a href="#node-js">What is Node?</a></li>
                    <li><a href="#node-features">Features</a></li>
                    <li><a href="#node-uses">Who uses node?</a></li>
                </ul>
            </li>
        </ul>
        <ul>
            <!-- Installation-->
            <li><a href="#intro">Getting Started</a>
                <ul>
                    <li><a href="#requirements">Installation Requirements</a></li>
                    <li><a href="#npm">The <strong>npm</strong> (Node package manager)</a>
                    <li><a href="#hello">The <strong>npm</strong> Hello World!</a>
                </ul>
            </li>
        </ul>
        <ul>
            <li><a href="#modules">Modules</a>
                <ul>
                    <li><a href="#mod-incl">Including modules</a></li>
                    <li><a href="#mod-built">Node Built-ins</a></li>
                </ul>
            </li>
        </ul>
        <ul>
            <li><a href="#the-http">The <strong>http</strong> module</a>
                <ul>

                </ul>
            </li>
        </ul>
        <ul>
            <li><a href="#express">Express - A lightweight web framework for Node</a>
                <ul>

                </ul>
            </li>
        </ul>
        <ul>
            <li><a href="#database">Database Access</a>
                <ul>
                    <li><a href="#mongodb">MongoDB via the <strong>mongodb</strong> module</a></li>
                    <li><a href="#mysql">MySQL via the <strong>mysql</strong> module</a></li>
                </ul>
            </li>
        </ul>
        <ul>
            <li><a href="#intro">Aside from Express we have - Sails and Meteor too!</a>
                <ul>

                </ul>
            </li>
        </ul>
    </nav>
    <article>
        <h2 id="intro">Introduction</h2>
        <h3 id="node-js">Node JS</h3>
        <p>Node.js is an open source server framework which is built on top of the JavaScript V8 engine mostly used for
            web development - specially for network intensive single page apps, it is free, cross-platform and
            uses one of the most popular programming language - JavaScript
        </p>
        <h3 id="node-features">Features</h3>
        <p>The following are the most popular feature why Node JS is used:</p>
        <ul>
            <li><strong>Asynchronous and Event Driven</strong>
                <p>With the advent of the web there needs to be some kind of way to execute tasks upon receiving them,
                    in
                    the past this is done sychornously, meaning you need to wait for a certain code to finish before you
                    can
                    execute another task, though this can be mitigated by using Threads in some languages, a more
                    powerful
                    approach that Node is built upon is that all of its library API was built asychronous first and an
                    event
                    driven mechanism. Meaning for instance in reading a file you don't need to wait for that block of
                    code
                    to
                    finish before moving through the next one.
                </p>
            </li>
            <pre><code class="javascript">
           var fs = require('fs');
            fs.readFile(function(err, data){
                console.log('data');
            });
            console.log('This will be executed first, depending on the size of the file');
        </code></pre>
            <li><strong>Its Fast!</strong>
                <p>As noted above Node js is built on top of the V8 and there is no question that the V8 engine is one
                    of
                    the
                    best JavaScript engine out there in terms of speed
                </p>
            </li>
            <li><strong>Single Threading</strong>
                <p>Node uses a single threaded model with event looping. Meaning there are no threads in Node, it
                    accomplishes
                    tasks -again - in an event driven fashion in a asychronous way. In a way this model can serve a much
                    larger request pool
                    than the traditional Threaded model such as being used on Java or Apache (Php) servers</p>
                <p>More information can be found on <a
                        href="http://stackoverflow.com/questions/17959663/why-is-node-js-single-threaded">this</a>
                    stackoverflow thread
                </p>
            </li>
            <li><strong>License</strong>
                <p>Node.js is published under an MIT license which means it is free and open source and can be used
                    commercially without charge</p>
            </li>

            <h3 id="node-uses"> Who uses Node?</h3>

            <p>Even still at it's infancy Node is now being used by companies such as:</p>
            <ul>
                <li>Netflix</li>
                <li>New York times</li>
                <li>Paypal</li>
                <li>Yahoo</li>
                <li>LinkedIn</li>
                <li>Uber</li>
            </ul>

        </ul>
    </article>
    <article>
        <h2 id="requirements">Requirements</h2>
        <p>In order to start developing using Node we need to install the node js package. As discussed above Node is
            cross-platform it is available on Windows, Mac and Linux. You can acquire the latest version of node
            here:</p>
        <h3>Windows</h3>
        <p>Node JS - <a href="https://nodejs.org">Download</a></p>
        <h3>Mac OS</h3>
        <p>On mac if <code>brew</code> is installed you can execute</p>
        <pre><code>brew install node</code></pre>
        <h3>Linux</h3>
        <p>On linux using apt-get:</p>
        <pre><code>sudo apt-get install nodejs</code></pre>
        <h3>Test</h3>
        <p>After installation you can go to your command line and confirm the node installation:</p>
        <pre><code>$: node -v</code></pre>
        <p>It should print your node version</p>
        <pre><code>v6.9.1</code></pre>

        <h2 id="npm">Node Package Manager (NPM)</h2>
        <p>After the node installation, you will notice that if you type <code>npm</code> on your command line node
            actually installed npm. NPM is the built-in package manager for node, and with npm you can install modules
            which
            are available on the npm website. NPM acts like the other package managers out there such as composer,
            rubygems, and maven but for installing Node.js packages. For instance if you want to install the package
            <code>nodemon</code> - which is a daemon which reloads the server when changes are made - you just type</p>
        <pre><code>
            npm install nodemon
        </code></pre>
        <p>This automatically generates a <code>node_modules</code> folder which then contains the installed package.
            NPM is also a dependency management tool which means if nodemon is dependent on other modules it
            automatically installs those modules for us
        </p>

        <h2 id="hello">Hello from Node!</h2>
        <p>In this section we take a look on how simple it is to construct the famous hello world using node.</p>
        <h3>app.js</h3>
        <pre><code>console.log("Hello World!")</code></pre>
        <h3>To run using the command line:</h3>
        <pre><code>
            $: node app.js
            Hello World!
        </code></pre>
        <p>In the next section we talk about how to use the http module to create the same Hello World but with a web
            server.</p>
    </article>
    <article>
        <h2 id="modules">Modules</h2>
        <p>The Node core API is a small fish in comparison to the more mature programming languages out there such as
            Java, Php, Ruby and .Net, but here comes modules for the resuce. A module in node is simply a fancy way of
            saying libraries
            which just contains a set of functions or objects that you can include in your application. The beauty of
            this is that there are modules for almost anything that you want to do in Node these days, because of Node's
            openness. There are the built-in modules, modules created by the ecosystem and lastly modules that can
            be created by us - the developers.</p>
        <h2 id="mod-incl">Including modules</h2>
        <p>We are accustomed using Java in our university and we do inclusion of files using the <code>import</code>
            statement.
            In node there is this equivalent function called <code>require</code>, which is used to "require" other
            modules or files</p>
        <h3>Including built-in or installed modules via npm</h3>
        <pre><code class="js">
    // This includes the file system module
    var fs = require('fs')
    // requiring the express module
    var express = require('express');
        </code></pre>
        <h2 id="mod-built">Node.js Built-in modules</h2>
        <p>There are a lot of built-in modules in node below are the most common one's. The full list can be viewed <a
                href="https://nodejs.org/en/docs/">here</a></p>
        <table class="table table-bordered table-striped">
            <tr>
                <th>assert</th>
                <td>Module for asserting tests</td>

            </tr>
            <tr>
                <th>crypto</th>
                <td>Module for handling OpenSSL encryption</td>
            </tr>
            <tr>
                <th>fs</th>
                <td>File system - reading and writing files</td>
            </tr>
            <tr>
                <th>http</th>
                <td>Module for creating a HTTP server</td>
            </tr>
            <tr>
                <th>https</th>
                <td>Module for creating a HTTPS server</td>
            </tr>
            <tr>
                <th>net</th>
                <td>Module for creating network servers and clients</td>
            </tr>
            <tr>
                <th>querystring</th>
                <td>Module for handling URL query strings</td>
            </tr>
            <tr>
                <th>url</th>
                <td>Module for parsing URL a string</td>
            </tr>
            <tr>
                <th>util</th>
                <td>Utility functions</td>
            </tr>
            <tr>
                <th>zlib</th>
                <td>Module for compressing/decompressing files</td>
            </tr>
        </table>
    </article>
    <article>
        <h2 id="the-http">The <strong>http</strong> module</h2>
        <p>The http module is a built-in module that you can use to create a simple HTTP web server. To include this
            module you do:</p>
        <pre><code>var http = require('http');</code></pre>
        <p>The <strong>http</strong> module has plenty of methods, but for the basics let's use the <code>createServer()
            and the <code>listen()</code> methods</code></p>
        <pre><code>
    // require the built in http module
    var http = require('http');

    //create the server
    var myServer = http.createServer(function (req, res) {
      // To write headers
      res.writeHead(200, {'Content-Type': 'text/html'});
      // Get the req parameters using the req variable
      res.write(req.url);
      res.write('Hello World from Express!'); //write a response to the client
      res.end(); //end the response
    });
    myServer.listen(3000); // Have the port listen to port 3000
        </code></pre>
        <p>If we run our browser to port 3000 we see this</p>
        <img class="img-responsive img-thumbnail" src="../images/http-hello.png" alt="">
        <p>This is just a simple way to demonstrate how Node can be a web server and at the same time a web framework.
            In the next section we go through Express which is arguably the most popular web framework for Node</p>
    </article>
    <article>
        <h2 id="express">Express JS</h2>
        <p>In the previous section it was discussed that Node has it's own module for creating web sites, but it can
            get a little messy when it comes to complicated sites. The solution is to use a Web Framework to abstract
            and have it a little bit easy to make web applications</p>
        <p><strong>Express</strong> is built on top of node so every functionality of Node can be used in an express
            app,
            the basics can be as followed:
        </p>
        <h3>First install express on your app</h3>
        <pre><code>npm install express</code></pre>
        <h3>Then on our app.js</h3>
        <pre><code>
    // Require express
    var express = require('express')
    var app = express() // instanstiate the app

    app.get('/', function (req, res) {
      res.send('Hello World from Express!')
    })
    // Let the app listen to port 3000
    app.listen(3000, function () {
      console.log('Example app listening on port 3000!')
    })
        </code></pre>
        <p>As we can see above this is quite similar to the http module, except for the <code>.get</code> portion. Now
            we
            have the http methods built into express so we don't need to manually do it ourselves using the http module.
            Now
            for instance we wanted a post request on a given url we can just do this</p>
        <pre><code>
    app.post('/submit', function (req, res) {
      // do code
    })
    </code></pre>
        <p>But offcourse we need to get the request parameters from the post request. In the past versions of express
            there
            is a built in module to do this - <code>body-parser</code>. But to modularize the modules they separated
            this
            into a module. We need to install this to parse the parameters</p>
        <pre><code>npm install body-parser</code></pre>
        <p>Now consider the following html code</p>
        <pre><code>
    &#x3C;form method=&#x22;post&#x22; action=&#x22;/submit&#x22;&#x3E;
     &#x3C;input type=&#x22;text&#x22; name=&#x22;username&#x22;&#x3E;
     &#x3C;input type=&#x22;password&#x22; name=&#x22;password&#x22;&#x3E;
    &#x3C;/form&#x3E;
    </code></pre>
        <p>Now in the server we use the installed body-parser</p>
        <pre><code>
    var bodyParser = require('body-parser')
    app.use( bodyParser.json() );       // to support JSON-encoded bodies
    app.use(bodyParser.urlencoded({     // to support URL-encoded bodies
      extended: true
    }));
    app.post('/submit', function (req, res) {
        // To retrieve the parameters
        var username = req.body.username;
        var password = req.body.password;
        // ... do something with the variables
    })
    </code></pre>
        <p>As we can see there are a lot of things that are simple to do when using a framework such as express. There
            is so
            much more to this especially using the more advanced modules available in the NPM. This is just the top of
            the
            iceberg of what can be accomplished using Express.</p>
    </article>
    <article>
        <h2 id="database">Database Connectivity</h2>

        <h3 id="mongodb">MongoDB using the mongodb module</h3>
        <p>Like coffee and creamer Mongodb and Node are meant for each other. Node uses JavaScript, JavaScript uses
            JSON (JavaScript Object Notation) and MongDB although not the same, uses similar functions, syntax and
            approaches in connecting to the database</p>
        <h4>First we need to install the required module</h4>
        <pre><code>npm install mongodb</code></pre>
        <p>Assuming that your mongodb server is running and we have the following credentials and database, we can do
            the following to get all the records</p>
        <pre><code>
    // Require mongo and assert(Optional)
    var MongoClient = require('mongodb').MongoClient
      , assert = require('assert');

    // Connection URL
    var url = 'mongodb://localhost:27017/webtek-database-finals';
    // Connect to the server
    MongoClient.connect(url, function(err, db) {
      assert.equal(null, err);
      console.log("Connected correctly to server");
      var findDocuments = function(db, callback) {

      // Get the documents collection
      var collection = db.collection('registration');

      // Find some documents
      collection.find({}).toArray(function(err, docs) {
        assert.equal(err, null);
        console.log("Registration records");
        // print like a minitature DOM
        console.dir(docs);
      });
    }
      db.close();
    });

        </code></pre>
        <p>This is how we connect and retrieve from a MongoDB database. It may look like a mess at first because of the
            callbacks but this is a fairly JavaScript issue and not a Monog one. The following are resources that we
            can use for further reading:</p>
        <ul>
            <li><a href="https://www.mongodb.com/">MongoDB Documentation</a></li>
            <li><a href="https://www.npmjs.com/package/mongodb">The mongodb module</a></li>
        </ul>
        <h3 id="mysql">MySQL using the mysql module</h3>
        <p>Although not use as much easier and used with Node, we attest to the fact that MySQL is still arguably one of
            the most used database with all the databases. In node we can connect it to a mysql server using the
            lightweight, 100% JavaScript module - <code>mysql</code></p>
        <h4>First let's install the required module</h4>
        <pre><code>npm install mysql</code></pre>
        <p>After installation, with the assumption that we have a mysql server running and with the credentials below we
            can use it as follows:</p>
        <pre><code>
    // require the module
    var mysql      = require('mysql');

    // create the connection parameters
    var connection = mysql.createConnection({
      host     : 'localhost',
      user     : 'root',
      password : '',
      database : 'webtek-database-finals'
    });

    connection.connect();

    connection.query('SELECT * FROM registration', function (error, results, fields) {
      if (error) throw error;
      // The results are converted in a familiar JSON format
      console.log('The database results: ', results);
      // So if we want the first of the results
      console.log("The first result: " + results[0].fname);
    });
    // close the connection
    connection.end();
        </code></pre>
        <p>As you can see it is fairly easy and straightforward to integrate node with a mysql database. For more
            information in the use of MySQL we can consult the documentation <a href="https://github.com/mysqljs/mysql">here</a>
        </p>
    </article>
</div>

<script src="../js/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
